<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order History Details</title>
    <!-- brostrap cdn link  -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
     <!--  -->
     <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</head>
<body>
  

   <div class="container  d-flex flex-column justify-content-center" style="height: 100vh;">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="/orderhistory" style="text-decoration: none;">Order History</a></li>
          <li class="breadcrumb-item active" aria-current="page">Order Details</li>
        </ol>
      </nav>
       <div class="row" style="height: 500px;">
           <div class="col-6 p-3">
            <h3>Order Address</h3>
            <div class="border rounded shadow h-75 p-4">
              <p><b>Name: <%=checkout.address.username %> </b></p>
              <p><b>phone: <%=checkout.address.phone %> </b></p>
              <p><b>country: <%=checkout.address.country %>  </b></p>
              <p><b>state: <%=checkout.address.state %> </b></p>
              <p><b>locality: <%=checkout.address.locality %> </b></p>
              <p><b>landmark: <%=checkout.address.landmark %> </b></p>
              <p><b>zip: <%=checkout.address.zip %> </b></p>
            </div>
           </div>
           <div class="col-6 d-flex align-items-center" style="height: 500px;">
             <div class="row shadow rounded p-3 " style="height: 400px;">

                <div class=" d-flex" style="overflow-x: scroll;">

               
            <% checkout.cart.items.forEach((item, index) => { %>
               
                    <div class="mx-3 p-3 col-6 border shadow-sm rounded d-flex" style="height: 200px;">
                        <div class="col-4 h-100">
                            <% 
                            const variant = item.product.variants.find(variant => variant?.color === item.variant?.color);
                            if (variant && variant.imageUrls && variant.imageUrls.length > 0) {
                            %>
                                <img class="img-fluid mt-4 rounded-3" src="<%= variant?.imageUrls[0] %>" class="card-img-top" alt="Product Image">
                            <% } else { %>
                                <img class="img-fluid mt-4 rounded-3" src="" class="card-img-top" alt="No Image Available">
                            <% } %>
                        </div>
                        <div class="px-4 mt-3" style="line-height: 1;">
                            <p><%= item?.productName %></p>
                            <p>quantity: <%= item?.quantity %></p>
                            <p>color: <%= item.variant?.color %></p>
                            <p>size: <%= item.variant?.size %></p>
                        </div>
                    </div>
                   
               
            <% }) %>
             </div> 
                 <div class="" style="height: 100px;">
                    
                    <div class="col-3 w-100" style="height: 50px;">
                        <p style="float: right;padding-right: 50px;margin-top: 12px;">Total: â‚¹ <%= checkout.cart?.totalAmount %></p>
                    </div>
                    <div class="col-3 w-100 d-flex justify-content-between align-items-center px-5" style="height: 50px;">
                        <div>
                            <p class="mt-3">Order Status: <%= checkout.orderStatus %></p>
                        </div>
                        <div>
                            <!-- cancel disabled js -->
                            <% if (checkout.orderStatus === "Processing") { %>
                                <button class="btn btn-danger px-5" onclick="confirmCancel('<%= checkout._id %>')">Cancel</button>
                            <% } %>
                            
                           
                        </div>
                    </div>
                  </div>
             </div>    
        </div>
        
       </div>
   </div>


   <script>
    function confirmCancel(orderId) {
        Swal.fire({
            title: 'Are you sure?',
            text: "You won't be able to revert this!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes, cancel it!'
        }).then((result) => {
            if (result.isConfirmed) {
                window.location.href = `/cancelOrder/${encodeURIComponent(orderId)}`;
            }
        })
    }
</script>
   
   
</body>
</html>